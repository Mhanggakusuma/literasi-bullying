{% extends 'base.html' %}
{% load static %}
{% block title %}Tindak Lanjut Kasus{% endblock %}

{% block content %}
<section class="bk-tindak-lanjut">

<div class="bk-tl-hero">
<div class="container">

<!-- HEADER -->
<div class="bk-tl-header text-center">
<h1 class="bk-tl-title">Tindak Lanjut Kasus Bullying</h1>
<p class="bk-tl-subtitle">Data bersifat rahasia</p>
</div>

<!-- GRID UTAMA -->
<div class="bk-tl-grid mt-4">

<!-- ================= KOLOM KIRI ================= -->
<div class="bk-left">

<!-- INFO LAPORAN -->
<div class="bk-card">
<h5>Informasi Laporan</h5>

<p><strong>Kode :</strong> {{ laporan.kode_laporan }}</p>

<p>
<strong>Status :</strong>
<span class="badge
{% if laporan.status == 'selesai' %}bg-success
{% elif laporan.status == 'diproses' %}bg-warning text-dark
{% else %}bg-secondary{% endif %}">
{{ laporan.get_status_display }}
</span>
</p>

<p><strong>Tanggal :</strong> {{ laporan.tanggal|date:"d M Y" }}</p>

<p><strong>Jenis :</strong> {{ laporan.get_jenis_bullying_display }}</p>

</div>

<!-- PIHAK TERLIBAT -->
<div class="bk-card">
<h5>Pihak Terlibat</h5>

<p><strong>Korban :</strong>
{{ laporan.tampilkan_korban }} ({{ laporan.kelas_korban }})
</p>

{% if laporan.nama_terlapor %}
<p><strong>Terlapor :</strong>
{{ laporan.nama_terlapor }} ({{ laporan.kelas_terlapor }})
</p>
{% endif %}

<p><strong>Lokasi :</strong> {{ laporan.lokasi_kejadian }}</p>

</div>

<!-- KRONOLOGI -->
<div class="bk-card">
<h5>Kronologi</h5>
<div class="bk-scroll-box">
{{ laporan.isi_laporan|linebreaksbr }}
</div>
</div>

<!-- DAMPAK -->
{% if laporan.dampak_korban %}
<div class="bk-card">
<h5>Dampak</h5>

<ul>
{% for d in laporan.dampak_korban %}
<li>{{ d }}</li>
{% endfor %}
</ul>

</div>
{% endif %}

</div>


<!-- ================= KOLOM KANAN ================= -->
<div class="bk-right">

<!-- FORM BK -->
<div class="bk-card sticky-card">
<h5>Tindak Lanjut BK</h5>

<form method="post" enctype="multipart/form-data">
{% csrf_token %}

<label>Catatan BK</label>
{{ form.catatan_bk }}

<label class="mt-2">Upload Bukti</label>
{{ form.bukti_tindak_lanjut }}

<button class="bk-btn-primary mt-3">
Simpan Tindak Lanjut
</button>

{% if laporan.status != "selesai" %}
<button type="submit" name="selesai" value="1"
class="btn btn-success w-100 mt-2">
Tandai Selesai
</button>
{% endif %}

</form>

<a href="{% url 'bk_dashboard' %}"
class="btn btn-outline-secondary w-100 mt-3">
‚Üê Kembali
</a>

</div>

<!-- IDENTITAS INTERNAL -->
<details class="bk-card">
<summary>üîê Identitas Pelapor</summary>

<p>Nama :
{{ laporan.pelapor.get_full_name|default:laporan.pelapor.username }}</p>

<p>NIS :
{{ laporan.pelapor.profile.nis }}</p>

<p>Kelas :
{{ laporan.pelapor.profile.kelas }}</p>

</details>

</div>

</div>
</div>
</div>
</section>
{% endblock %}
