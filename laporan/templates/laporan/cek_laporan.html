{% extends 'base.html' %}
{% load static %}

{% block title %}Cek Status Laporan{% endblock %}

{% block content %}
<section class="cek-laporan-hero cek-laporan-page">
<div class="container text-center">

<h1 class="cek-laporan-title">Cek Status Laporan</h1>
<p class="cek-laporan-subtitle">
Kerahasiaan identitas dijaga untuk keamanan semua pihak
</p>

<!-- ================= INPUT ================= -->
<div class="cek-laporan-card cek-card-small mx-auto mt-5">

<img src="{% static 'img/shield.png' %}" class="cek-laporan-icon-small">

<h3 class="cek-laporan-card-title">Masukkan Kode Laporan</h3>

<form method="post">
{% csrf_token %}

<input type="text"
name="kode"
class="cek-laporan-input"
placeholder="Contoh: LP-2025-001"
required>

<button type="submit" class="cek-laporan-btn-primary mt-3">
ğŸ” Cek Status
</button>

</form>
</div>

{% if laporan %}

<!-- ================= DETAIL LAPORAN ================= -->
<div class="cek-laporan-detail-card mx-auto mt-5">

<!-- HEADER TENGAH -->
<div class="cek-detail-header-center">
<img src="{% static 'img/ribbon.png' %}" class="cek-detail-icon-center">
<h4>Detail Laporan</h4>
</div>

<!-- GRID INFORMASI -->
<div class="cek-grid">

<div class="cek-item">
<label>Pelapor</label>
<span>Anonim ğŸ”’</span>
</div>

<div class="cek-item">
<label>Korban</label>
<span>{{ laporan.tampilkan_korban }} ({{ laporan.kelas_korban }})</span>
</div>

{% if laporan.nama_terlapor %}
<div class="cek-item">
<label>Terlapor</label>
<span>
{{ laporan.nama_terlapor }}
{% if laporan.kelas_terlapor %}
({{ laporan.kelas_terlapor }})
{% endif %}
</span>
</div>
{% endif %}

<div class="cek-item">
<label>Jenis Perundungan</label>
<span>{{ laporan.get_jenis_bullying_display }}</span>
</div>

<div class="cek-item">
<label>Tanggal Kejadian</label>
<span>
{{ laporan.tanggal_kejadian|date:"d M Y" }}
{% if laporan.perkiraan_waktu %}
({{ laporan.get_perkiraan_waktu_display }})
{% endif %}
</span>
</div>

<div class="cek-item">
<label>Lokasi</label>
<span>{{ laporan.lokasi_kejadian|default:"-" }}</span>
</div>

</div>

<!-- ================= GRID SECTION ================= -->
<div class="cek-grid-section">

<!-- KRONOLOGI -->
<div class="cek-item-box">
<h5>Kronologi</h5>
<p>{{ laporan.isi_laporan|linebreaksbr }}</p>
</div>

<!-- DAMPAK -->
<div class="cek-item-box">
<h5>Dampak</h5>

{% if laporan.dampak_korban %}
<ul>
{% for d in laporan.dampak_korban %}
<li>{{ d }}</li>
{% endfor %}
</ul>
{% else %}
<p>-</p>
{% endif %}
</div>

<!-- HARAPAN -->
<div class="cek-item-box">
<h5>Harapan Pelapor</h5>
<p>{{ laporan.harapan_pelapor|default:"-"|linebreaksbr }}</p>
</div>

<!-- STATUS -->
<div class="cek-item-box text-center">
<h5>Status Laporan</h5>

<div class="status-pill">
{{ laporan.get_status_display }}
</div>

</div>

</div>

<!-- CATATAN BK -->
{% if laporan.catatan_bk %}
<div class="cek-catatan-box mt-4">
<h6>Catatan Guru BK</h6>
<p>{{ laporan.catatan_bk|linebreaksbr }}</p>
</div>
{% endif %}

<!-- BUTTON -->
<div class="cek-action mt-4">

{% if laporan.bukti_tindak_lanjut %}
<a href="{{ laporan.bukti_tindak_lanjut.url }}"
target="_blank"
class="cek-laporan-btn-success">
ğŸ“ Bukti Tindak Lanjut
</a>
{% endif %}

<a href="{% url 'laporan_home' %}"
class="btn btn-outline-secondary">
â† Kembali
</a>

</div>

</div>
{% endif %}

</div>
</section>
{% endblock %}
