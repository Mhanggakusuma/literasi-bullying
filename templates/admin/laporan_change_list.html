{% extends "admin/change_list.html" %}

{% block object-tools-items %}

{{ block.super }}

<li style="width:100%; list-style:none;">

<h2 style="margin-top:30px;">Dashboard Analitik Bullying</h2>

<p>
<strong>Total:</strong> {{ total_laporan }} |
<strong>Baru:</strong> {{ laporan_baru }} |
<strong>Diproses:</strong> {{ sedang_diproses }} |
<strong>Selesai:</strong> {{ selesai }}
</p>

<div style="display:grid; grid-template-columns:repeat(2,1fr); gap:25px; margin-top:20px;">

<div style="height:350px;">
<canvas id="statusChart"></canvas>
</div>

<div style="height:350px;">
<canvas id="jenisChart"></canvas>
</div>

<div style="height:350px;">
<canvas id="kelasChart"></canvas>
</div>

<div style="height:350px;">
<canvas id="trenChart"></canvas>
</div>

</div>

</li>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>

function buildChart(id, type, labels, data){
new Chart(document.getElementById(id),{
type:type,
data:{
labels:labels,
datasets:[{
label:"Jumlah",
data:data
}]
},
options:{
responsive:true,
maintainAspectRatio:false,
scales:{
y:{beginAtZero:true}
}
}
});
}

/* STATUS */
buildChart(
"statusChart",
"pie",
[{% for i in grafik_status %}"{{ i.status }}",{% endfor %}],
[{% for i in grafik_status %}{{ i.total }},{% endfor %}]
);

/* JENIS */
buildChart(
"jenisChart",
"bar",
[{% for i in grafik_jenis %}"{{ i.jenis_bullying }}",{% endfor %}],
[{% for i in grafik_jenis %}{{ i.total }},{% endfor %}]
);

/* KELAS */
buildChart(
"kelasChart",
"bar",
[{% for i in grafik_kelas %}"{{ i.kelas_korban }}",{% endfor %}],
[{% for i in grafik_kelas %}{{ i.total }},{% endfor %}]
);

/* TREN */
buildChart(
"trenChart",
"bar",
[{% for i in grafik_tren %}"{{ i.bulan|date:'M Y' }}",{% endfor %}],
[{% for i in grafik_tren %}{{ i.total }},{% endfor %}]
);

</script>

{% endblock %}
